<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
        crossorigin="anonymous"></script>
    <style>
        #name {
            /*background-color: rgb(132,206,209);*/
            background-color: rgb(139, 196, 191);
            border-left: 1vw solid rgb(32, 178, 170);
            border-bottom: 1vw solid rgb(32, 178, 170);
            border-radius: 10px;
            width: 98vw;
            text-align: center;
            padding: 10px 0;
            font-weight: bold;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }

        .container {
            border-left: 1vw solid rgb(195, 195, 195);
            border-bottom: 1vw solid rgb(195, 195, 195);
            border-top: 0.5vw solid rgb(195, 195, 195);
            border-right: 0.5vw solid rgb(195, 195, 195);
            background-color: mintcream;
            border-radius: 10px;
            width: 100vw;
            margin: 21px auto;
            padding: 35px;
            font-size: 3vw;
            line-height: 1;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }

        img{
            width: 100%;
        }

        .working h4,
        .complexity h4 {
            text-decoration: underline;
        }

        .implementation,
        .code {
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="entire">
        <div class="head"><br>
            <h2 id="name">OPTIMAL PAGE REPLACEMENT</h2>
            <div class="container">
                <h5>
                    This algorithm replaces the page which will not be referred for so long in future. Although it
                    can
                    not be practically implementable but it can be used as a benchmark. Other algorithms are
                    compared to
                    this in terms of optimality. This decides which memory page is to be
                    replaced. The process of replacement is sometimes called swap out or write to disk. It is
                    done when the requested page is not found in the main memory.
                </h5>
            </div>
        </div>

        <div class="algorithm">
            <h2 id="name">ALGORITHM</h2>
            <div class="container">
                <h5>
                    1. Push the first page in the array as per the memory demand.<br><br>
                    2. Push the second page as per the memory demand.<br><br>
                    3. Push the third page until the memory is full.<br><br>
                    4. As the array is full, the page which is least recently used is replaced.<br><br>
                    5. repeat step '4' until the page demand continues and until the processing is over.<br><br>
                    6. Terminate the program.<br><br>
                </h5>
            </div>
        </div>

        <div class="working">
            <h2 id="name">WORKING</h2>
            <div class="container">
                <h5>
                    Consider the page replacement string and number of frames as an example: pages = [ 7, 0, 1, 2,
                    0, 3, 0, 4, 2, 3, 0, 3, 2] and 4 respectively.<br><br>
                    <img src="https://i0.wp.com/technobyte.org/wp-content/uploads/2019/12/sym-1.jpg?ssl=1">
                    <br><br><li>Initially all the memory slots will be empty so [7, 0, 1, 2] will be allocated to the memory
                    with 4 page-faults.</li><br>
                    <li>As [0] is already there, there’s no page fault.</li><br>
                    <li>Next in the string is [3] it’ll replace [7] as it’s not used for the longest period of time
                    in the future, with one page
                    fault.</li><br>
                    <li>Again, 0 is already there, so no page fault.</li><br>
                    <li>4 will replace 1 with one page fault.</li><br>
                    <li>For the rest of the string, there will be no page fault as all the arriving pages are
                    already
                    there in the memory.</li><br>
                </h5>
            </div>
        </div>
        <div class="implementation">
            <h2 id="name">IMPLEMENTATION</h2>
            <div class="container">
                <div class="row">
                    <div class="col-md-4"></div>
                    <div class="col-md-4">
                        <h4>Enter input one by one: </h4>
                        <input type="number" class="form-control" id="input" placeholder="Enter a valid number:">
                    </div>
                </div><br>
                <button onclick="add()" class="btn btn-primary" id="add">Add</button><br><br>
                <h4 id="every"></h4>
                <div class="row">
                    <div class="col-md-4"></div>
                    <div class="col-md-4">
                        <h4>Enter number of frames: </h4>
                        <input type="number" class="form-control" id="input1" placeholder="Enter a valid number:">
                    </div>
                </div><br>
                <h4>Click the below button to get result :</h4>
                <button class="btn btn-primary" onclick="answer()">Submit</button><br><br>
                <h4 id="result"></h4>
            </div>
        </div>
        <h2 id="name">CODE</h2>
        <div class="container">
            <div class="code">
                <h4 style="text-align:center">Click the button to get the code:</h4>
                <button class="btn btn-primary" style="text-align:center" type="button" onclick="show()">Code</button>
            </div>
            <div id="codes" style="display:none;">
                <pre><h5>
function optimalPage(pg, pn, fn) {
    var pfpercent, phpercent, fault;
    var fr = new Array(fn);
    var hit = 0, index = 0;
    for (var i = 0; i < pn; i++) {
        if (search(pg[i], fr)) {
            hit++;
            continue;
        }
        if (index < fn) {
            fr[index++] = pg[i];
        }else {
            var j = predict(pg, fr, pn, i + 1);
            fr[j] = pg[i];                            
        }
    }
}

function predict(pg, fr, pn, index) {
    let res = -1;
    var farthest = index;
    var index;
    for (var i = 0; i < fr.length; i++) {
        for (var j = index; j < pn; j++) {
            if (fr[i] == pg[j]) {
                if (j > farthest) {
                    farthest = j;
                    res = i;
                }
                break;
            }
        }
        if (j == pn) {
            return i;
        }
    }
    if (res == -1) {
        return o;
    } else {
        return res;
    }
}
            </h5></pre>
            </div>
        </div>
        <script type="text/javascript">
            var input = document.getElementById("input");
            input.addEventListener("keypress", function (event) {
                if (event.key === "Enter") {
                    event.preventDefault();
                    document.getElementById("add").click();
                }
            });
            var i = 0;
            var str = "";
            var pg = [];
            function add() {
                var val = document.getElementById("input").value;
                pg[i] = parseInt(val);
                document.getElementById("input").value = "";
                i += 1;
                document.getElementById("every").innerHTML = pg;
            }

            function answer() {
                var pn = pg.length;
                var fn = parseInt(document.getElementById("input1").value);
                optimalPage(pg, pn, fn);
            }

            function search(key, fr) {
                for (var i = 0; i < fr.length; i++) {
                    if (fr[i] == key) {
                        return true;
                    }
                }
                return false;
            }

            function predict(pg, fr, pn, index) {
                let res = -1;
                var farthest = index;
                var index;
                for (var i = 0; i < fr.length; i++) {
                    for (var j = index; j < pn; j++) {
                        if (fr[i] == pg[j]) {
                            if (j > farthest) {
                                farthest = j;
                                res = i;
                            }
                            break;
                        }
                    }
                    if (j == pn) {
                        return i;
                    }
                }
                if (res == -1) {
                    return o;
                } else {
                    return res;
                }
            }

            function optimalPage(pg, pn, fn) {
                var pfpercent;
                var phpercent;
                var fault;
                var fr = new Array(fn);
                var hit = 0;
                var index = 0;
                str += "The entered pages are" + '&nbsp;' + "[";
                for (var i = 0; i < pn; i++) {
                    if (i == pn - 1) {
                        str += String(pg[i]);
                    } else {
                        str += String(pg[i]) + "," + '&nbsp;';
                    }
                }
                str += "]" + "<br>" + "The entered number of frames is " + String(fn) + "<br>"+"<br>";
                for (var i = 0; i < pn; i++) {
                    if (search(pg[i], fr)) {
                        hit++;
                        continue;
                    }
                    if (index < fn) {
                        fr[index++] = pg[i];
                        str += "The page at which the page faults occurs is " + (i + 1) + "<br>";
                        str += "The frame is" + '&nbsp;';
                        str += "[";
                        for (let k = 0; k < (fr.length) - 1; k++) {
                            str += String(fr[k]) + "," + '&nbsp;';
                        }
                        str = str + fr[(fr.length) - 1];
                        str += "]";
                        str = str + "<br>"+"<br>";

                    } else {
                        var j = predict(pg, fr, pn, i + 1);
                        fr[j] = pg[i];
                        str += "The page at which the page faults occurs is " + (i + 1) + "<br>";
                        str += "The frame is" + '&nbsp;';
                        str += "[";
                        for (var k = 0; k < (fr.length) - 1; k++) {
                            str += String(fr[k]) + "," + '&nbsp;';
                        }
                        str = str + fr[(fr.length) - 1];
                        str += "]";
                        str = str + "<br>"+"<br>";
                    }

                }
                fault = pn - hit;
                str += "Total number of Page Faults = " + String(fault);
                str += "<br>Total number of Page Hits = " + String(hit)+"<br>";
                pfpercent = (fault / pn) * 100;
                phpercent = 100 - pfpercent;
                str += "<br>Page Faults Percentage : " + String(pfpercent.toFixed(5));
                str += "<br>Page Hits Percentage : " + String(phpercent.toFixed(5)) + "<br>" + "<br>";
                document.getElementById("result").innerHTML = str;
            }

            function show() {
                document.getElementById("codes").style.display = "block";
            }
        </script>
</body>

</html>